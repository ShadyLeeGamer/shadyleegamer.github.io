<!DOCTYPE HTML>
<!--
	Axiom by Pixelarity
	pixelarity.com | hello@pixelarity.com
	License: pixelarity.com/license
-->
<html>
	<head>
		<title>Untitled</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />

		<link rel="stylesheet" href="assets/css/loader.css" />
		
		<link rel="stylesheet" href="assets/css/main.css" />
		<link rel="stylesheet" href="assets/css/custom.css" />
		
		<link rel="stylesheet" href="assets/css/slideshowGallery.css" />

		<link rel="stylesheet" href="assets/css/slick.css" />
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick-theme.css">

		<link rel="stylesheet" href="highlight/styles/base16/material-palenight.min.css" />
		<script src="highlight/highlight.min.js"></script>
		<script>hljs.highlightAll();</script>

		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css">
	</head>
	<body class="no-sidebar is-preload">
		<div id="loader-wrapper">
			<span id="loader-spinner">
				<span id="loader-hover">
				</span>
			</span>
		</div>

		<div class="projects-header-wrapper">
			<nav id="nav"></nav>

		<div id="page-wrapper">
			<header id="project-header">
				<div id="big-reel">
					<video src="videos/okainos/reel.mp4" autoplay muted loop></video>
					<span id="filter"></span>
					<span id="fade"></span>
				</div>
				<h2 class="project-title">Okainos</h2>

				<p id="okainos" class="project-date scroll-transition"></p>
			</header>
			
			<div id="project-top" class="container">

				<div class="slick-slider template">
					<div class="slick-slide">
						<video src="videos/okainos/Turns_in_action.mp4"></video>
					</div>
					<div class="slick-slide">
						<iframe src="https://www.youtube.com/embed/I4HunMIyDJw"></iframe>
					</div>
					<div class="slick-slide">
						<img src="images/okainos/okainos-logo.png">
					</div>
					<div class="slick-slide">
						<img src="images/okainos/card-data-asset-firebase-json.png">
					</div>
					<div class="slick-slide">
						<img src="images/okainos/okainos-logo.png">
					</div>
				</div>

				<div class="description">
					<p>Okainos was a multiplayer card game inspired by Hearthstone. I was recruited as the lead developer by an artist i met in a game jam to help transition the game from alpha to closed beta.</p>
					<p>I built and integrated game systems and networking tools, teaching me how to use back-end technologies like Rest API, JavaScript, JSON, and Firebase's suite of tools, including the Realtime Database, Authentication, Hosting, and Cloud Storage.</p>


					<div class="image-and-text-container left">
						<div class="image-container">
							<a href="https://okainos-b8c7b.web.app/" target="_blank"><img src="images/okainos/website.jpeg"/></a>
						</div>
						<div class="text-container">
							<h3 class="project-heading">Alpha Testers!</h3>
							
							<p>One major challenge we faced was to see how all systems performed in action. To address this, we created a website to attract alpha testers, leveraging Firebase's free web hosting services. Additionally, I created networking editor tools to automate processes, streamlining the game's development and improving the testing process.</p>
						</div>
					</div>

					<ul class="spinner-list platform scroll-transition">
						<li>
							<div class="spinner" style="background: #ffffff;">
								<a href="https://github.com/ShadyLeeGamer/okainos-resources" target="_blank">
									<img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/github/github-original.svg" />
								</a>
	
							</div>
						</li>
					</ul>
				</div>
			</div>

			<div class="popup-image">
				<img src="images/okainos/back-end-user.png" alt="">
			</div>



			<div id="project-content-wrapper">
			<div class="project-content">

			<h1 class="projects-header side-title perspective">OKAINOS</h1>
			<div class="row">
						<div class="col-12">

							<div class="accordion">
								<div class="accordion-item">
									<div class="accordion-header">Card Deck Builder (Encoding & Decoding)</div>
									<div class="accordion-content">
										<p>In order to store the card decks created by players, a card deck code containing the details of the deck is imported and exported by the game. The code was designed with simplicity in mind for sharing and manual editing.</p>
										
										<div class="realtime-function">
											<div class="display">
												<h2>FRONT-END</h2>
												<video src="videos/okainos/card-deck-builder-front-end.mp4" autoplay loop muted></video>
											</div>
											<div class="display">
												<h2>BACK-END</h2>
												<video src="videos/okainos/card-deck-builder-back-end.mp4" autoplay loop muted></video>
											</div>
										</div>

										<p>Of course, before a card deck code is created and stored, the game compares the card deck against the player's card collection to see if all selected cards is available.</p>
									
										<div class="accordion">
											<div class="accordion-item">
												<div class="accordion-header">(C#) CODE SNIPPET - Card Deck Code Processing</div>
												<div class="accordion-content">
													<pre><code class="language-csharp hljs">/// <summary>
/// Convert card deck code to list of cards through validation
/// </summary>
/// <returns>A list of deck cards</returns>
public string GetCardDeckCode()
{
string cardDeckCode = "";
if (cardItems.Count > 0)
{
foreach (CardInDeckItem cardItem in cardItems)
cardDeckCode += new CardInGroup(cardItem.CardData.id, cardItem.CardQuantity).ToString(); // Returns id and quantity seperated by "*" and ","
cardDeckCode.Remove(cardDeckCode.Length - 1, 1);
}
return cardDeckCode;
}</code></pre>
<p>Card Deck Decoder</p>
						<pre><code class="language-csharp hljs">/// <summary>
/// Convert card deck code to list of cards through validation
/// </summary>
/// <returns>A list of deck cards</returns>
public CardInGroup[] DecodeCardDeckCode()
{
// array of cards
string[] cardIdsAndQuantities = code.Split(',', '*');
var qseudoDeckCards = new CardInGroup[cardIdsAndQuantities.Length / 2];
// Validation process
for (int i = 0; i < qseudoDeckCards.Length; i++)
{
int quantity;
// Get the quantity from text
if (int.TryParse(cardIdsAndQuantities[(i * 2) + 1], out quantity))
// 20 is max quantity
if (quantity <= 20)
	qseudoDeckCards[i] = new CardInGroup(cardIdsAndQuantities[i * 2], quantity);
}
return qseudoDeckCards;
}</code></pre>
<p>Card deck code validation is checked before</p>
<pre><code class="language-csharp hljs">struct CardDeckCodeValidationResponse
{
public CardInGroup[] DeckCards { get; private set; }
public CardAsset.Data[] CardData { get; private set; }
public string[] EvaluationLogs { get; private set; }

public CardDeckCodeValidationResponse(CardInGroup[] deckCards, CardAsset.Data[] cardData, string[] evaluationLogs)
{
DeckCards = deckCards;
CardData = cardData;
EvaluationLogs = evaluationLogs;
}
}
void ValidateCardDeck(CardInGroup[] pseudoDeckCards, Action<CardDeckCodeValidationResponse> response)
{
List<CardInGroup> validDeckCards = new List<CardInGroup>();
List<CardAsset.Data> validDeckCardDatas = new List<CardAsset.Data>();
List<string> evaluationLog = new List<string>();

int totalDeckCardsNo = 0;
// Validation check for each card
foreach (CardInGroup pseudoDeckCard in pseudoDeckCards)
{
// Ignore errors
if (pseudoDeckCard == null ||
pseudoDeckCard.quantity == 0)
continue;

// Compare player's card collection against chosen deck cards
foreach (CardInGroup collectionCard in PersistentData.user.cardCollection)
if (pseudoDeckCard.id == collectionCard.id)
	foreach (CardAsset.Data cardData in PersistentData.cardDatas)
		if (pseudoDeckCard.id == cardData.id) // Check if the deck card exists in the player's collection
		{
			bool quantityIsEnough = true;
			// Check if player has enough of the deck card
			foreach (CardInCollectionItem cardinCollecitonItem in cardCollectionManager.GetCardItems())
				if (cardinCollecitonItem.CardData.id == pseudoDeckCard.id)
					if (cardinCollecitonItem.CardQuantity < pseudoDeckCard.quantity)
					{
						int quantityDiff = pseudoDeckCard.quantity - cardinCollecitonItem.CardQuantity;
						pseudoDeckCard.quantity = pseudoDeckCard.quantity - quantityDiff;
						evaluationLog.Add("You don't have enough " + pseudoDeckCard.id + " cards! You're missing " + quantityDiff + ".");
						quantityIsEnough = false;
						break;
					}
			// If player has enough of deck card, then check if there is too much of the same card
			if (quantityIsEnough)
			{
				totalDeckCardsNo += pseudoDeckCard.quantity;
				if (totalDeckCardsNo > CARDS_IN_DECK_QUANTITY_MAX) // 20
				{
					// Failed validation
					validDeckCards = null;
					validDeckCardDatas = null;
					evaluationLog.Add("Total number of cards exceeds the max allowed of " + CARDS_IN_DECK_QUANTITY_MAX + ".");
					response(new CardDeckCodeValidationResponse(validDeckCards.ToArray(), validDeckCardDatas.ToArray(), evaluationLog.ToArray()));
					return;
				}

				// Add valid card
				validDeckCards.Add(pseudoDeckCard);
				validDeckCardDatas.Add(cardData);
			}
			break;
		}

// Check if card is missing from their collection or does not exist in the database
if (!validDeckCards.Contains(pseudoDeckCard))
{
bool cardDoesNotExist = true;
// Card is missing
foreach (CardAsset.Data cardData in PersistentData.cardDatas)
	if (pseudoDeckCard.id == cardData.id)
	{
		evaluationLog.Add("You don't have a " + pseudoDeckCard.id + " card in your collection!");
		cardDoesNotExist = false;
		break;
	}
// Card does not exist
if (cardDoesNotExist)
	evaluationLog.Add("Card \"" + pseudoDeckCard.id + "\" does not exist.");
}
}
response(new CardDeckCodeValidationResponse(validDeckCards.ToArray(), validDeckCardDatas.ToArray(), evaluationLog.ToArray()));
}</code></pre>
												</div>
											</div>
										</div>

									</div>
								</div>
								<div class="accordion-item">
									<div class="accordion-header">Card Data Assets and Launcher</div>
									<div class="accordion-content">
										<p>Since the game was in development, we had to find ways to reduce the amount of updates the alpha testers had to do from the game page.</p>
										<!--<h3>Left &amp; Right</h3>-->
								<h3>Card Data Asset</h3>
								<div class="image-and-text-container left">
									<div class="image-container">
										<img src="images/okainos/card-data-asset-firebase-json.png"/>
									</div>
									<div class="text-container">
										<p>The solution I implemented were card assets, which were used to store the data of cards including stats, effects, description, etc. The data was written and read in JSON between the editor and database and custom editor tools were used to automate the process.</p>
										<p>This allowed card nerfs or buffs to be updated across all devices behind the scenes.</p>
									</div>
								</div>
								
								<div class="image-and-text-container right">
									<div class="image-container">
										<img src="images/okainos/card-asset-inspector.png"/>
									</div>
									<div class="text-container">
										<p>However, this excluded card resources like materials as they were stored locally in the game.</p>
										<p>The solution we came up was to instead put a launcher app on the game page which would automatically retrieve updated versions of the game build from the Firebase Cloud Storage.</p>
									</div>
								</div>
								
								<h3>Launcher App</h3>
								<div class="image-and-text-container left">
									<div class="image-container">
										<img src="images/okainos/launcher-firebase-download-exceeded.png"/>
									</div>
									<div class="text-container">
										<p>Unfortunately, I ran into issues during testing as the Firebase project has reached its monthly limit of downloads. So we decided to put off the idea for now.</p>
									</div>
								</div>

									</div>
								</div>
								<div class="accordion-item">
									<div class="accordion-header">Booster Opening</div>
									<div class="accordion-content">

										<p>Boosters give you more cards and can be bought in the shop. The number of boosters you have along with your expanding card collection is updated in your account.</p>
										<div class="realtime-function">
											<div class="display">
												<h2>FRONT-END</h2>
												<video src="videos/okainos/booster-opening-front-end.mp4" autoplay loop muted></video>
											</div>
											<div class="display">
												<h2>BACK-END</h2>
												<!-- <video src="videos/okainos/card-deck-builder-front-end.mp4" autoplay loop muted></video> -->
												<video src="videos/okainos/booster-opening-back-end-.mp4" autoplay loop muted></video>
											</div>
										</div>
		
										<div class="image-and-text-container left">
											<div class="image-container">
												<img src="images/okainos/booster-probability-gradient.png"></span>
											</div>
											<div class="text-container">
												<p>Creative use of the Gradient component is made for visualising and editing the card rarity possibility allowing for unique chances for each booster chest type.</p>
											</div>
										</div>

									</div>
								</div>
								<div class="accordion-item">
									<div class="accordion-header">Authentication with Firebase and Itch.io Integration</div>
									<div class="accordion-content">
										<div class="image-and-text-container left">
											<div class="image-container">
												<img src="images/okainos/back-end-user.png"></span>
											</div>
											<div class="text-container">
												<p>An essential system I had to implement for the website was authentication. This was linked to the same database allowing people to login with the same account created on the website or the game!</p>
											</div>
										</div>
	
										<div class="image-and-text-container right">
											<div class="image-container">
												<img src="images/okainos/closed-beta-tester-key-group.png"></span>
											</div>
											<div class="text-container">
												<p>This system was also linked to Itch.io in order to private the game's access to only testers using Itch io’s key group feature. I generated a max of 100 keys and stored them in Firebase Cloud Storage. For every account created on the website, a key URL is pulled and stored in the user’s account for them to claim and access the game page via it from their profile page.</p>
											</div>
										</div>
	
										<p><span class="image left">
											<img src="images/okainos/closed-beta-tester-key-group.png" style="object-fit:contain;width:300px; height:400px;"/></span>

											<div class="accordion">
											<div class="accordion-item">
												<div class="accordion-header">(JS) CODE SNIPPET | Authentication Process</div>
												<div class="accordion-content">
													<p>This function is called upon pressing submit in the register page.</p>
													<pre><code class="language-js hljs">function OnRegisterInput()
{
	if (registerFormStep == 1) // Sign in mode
	{
		// Get user input
		email = registerForm['emailInput'].value;
		password = registerForm['passwordInput'].value;

		// Check if user already exists in the database, if so sign in, else sign up new account
		get(refDB(database, 'users/')).then(dataSnapshots =>
			{
				const users = keyfullObjectSnapshotToArray(dataSnapshots);
				users.forEach(user =>
					{
						if (email == user.email)
						{
							if(ValidateSignIn(email, password, users)) // Check if details are valid
								SignIn(email, password);
							return;
						}
					});

				if (ValidateSignUpEmailPassword(email, password, users)) // Check if details are valid
					setupRegisterFormInputs(registerFormStep = 2); // Setup register for sign up
			});
	}
	else if (registerFormStep == 2) // Sign up mode
	{
		get(refDB(database, 'users/')).then(dataSnapshots =>
			{
				const users = keyfullObjectSnapshotToArray(dataSnapshots);

				const username = registerForm['usernameInput'].value;

				if (ValidateSignUpUsername(username, users)) // Check if username already exists
					SignUp(email, password, username);
			});
	}
}</code></pre>
<p>This function is called after the player verified their account</p>

<pre><code class="language-js hljs">function GetClosedBetaTesterKey()
{
	const userClosedBetaTesterItchIoKeyURLRef = refDB(database, "users/" + auth.currentUser.uid + "/closedBetaTesterItchIoKeyURL");
	get(userClosedBetaTesterItchIoKeyURLRef)
		.then(userClosedBetaTesterKeyResponse =>
			{
				var urlKey = userClosedBetaTesterKeyResponse.val();
				// Check if user already has a key, if so then assign them one, else refresh the game page button with the key url
				if (urlKey == "")
				{
					// Add user to mail list
					SubscribeEmailToList(user.email);

					// Get keys list from Firebase Cloud Storage
					const closedBetaTesterKeysRef = refGS(storage, 'closed-beta-tester-keys.txt');
					getDownloadURL(closedBetaTesterKeysRef).then((url) =>
						{
							fetch(url).then(keysResponse =>
								{
									keysResponse.text().then(keysText =>
										{
											// Grab first key
											var nextKey = keysText.split('\n')[0];
											// Exclude the key from the list
											keysText = keysText.substring(nextKey.length + 1)
											uploadString(closedBetaTesterKeysRef, keysText);
											// Assign player with key
											set(userClosedBetaTesterItchIoKeyURLRef, nextKey)
												.then((response) =>
												{
													urlKey = nextKey
													RefreshSendClosedBetaTesterKeyButton(urlKey);
												});
										});
								});
						});
				}
				else
					RefreshSendClosedBetaTesterKeyButton(urlKey);
			});
}</code></pre>
												</div>
											</div>
										</div>
									</div>
								</div>
								<div class="accordion-item">
									<div class="accordion-header">Card Collection Filter Tool</div>
									<div class="accordion-content">
										<p>To help players strategize, I created a team planner with a filtering system that can sort cards by tribe, rarity, strength, price, draw. For further filtering, you can also check to only see cards owned in your collection or search by name.</p>
										<div class="image-center">
											<video src="videos/okainos/card-collection-filter-tool.mp4" autoplay loop controls></video>
											<img src="images/okainos/card-collection-back-end.png">
										</div>

										<p>Other functionalities include the ability to trade craft and scrap cards for salt and pearls.</p>
										<div class="realtime-function">
										<div class="display">
											<h2>FRONT-END</h2>
											<video src="videos/okainos/trading-front-end.mp4" autoplay loop muted></video>
										</div>
										<div class="display">
											<h2>BACK-END</h2>
											<!-- <video src="videos/okainos/card-deck-builder-front-end.mp4" autoplay loop muted></video> -->
											<video src="videos/okainos/trading-back-end.mp4" autoplay loop muted></video>
										</div>
									</div>
									</div>
								</div>
								<div class="accordion-item">
									<div class="accordion-header">Card Resources Manager</div>
									<div class="accordion-content">
										<div class="image-and-text-container left">
											<div class="image-container">
												<img src="images/okainos/card-data-asset-firebase-json.png"></span>
											</div>
											<div class="text-container">
												<p>A big issue we faced when testing a build of the game was that it would fail to load card resources like materials, sprites, and prefabs. This was due to the old method of storing the GUID of the assets on the database and using it to load the assets at runtime. Since this uses the UnityEditor namespace it does not work in a build.</p>
											</div>
										</div>
	
										<p>The solution I implemented was a resources manager which uses Unity’s persisting resources folder which is loaded for retrieving card resources. The correct resources are fetched by card id. This will also save space in the database</p>
										
										<div class="accordion">
											<div class="accordion-item">
												<div class="accordion-header">(C#) CODE SNIPPET - Card Deck Code Processing</div>
												<div class="accordion-content">
													<pre><code class="language-csharp hljs">public static class CardResourcesManager 
{
	public static Dictionary<string, CardResources> cardResourcesDictionary;
	public static void LoadCardResources()
	{
		cardResourcesDictionary = new Dictionary<string, CardResources>();

		Resources.LoadAsync("Cards");

		CardAsset.Data[] cardDatas = PersistentData.cardDatas;

		StaticCoroutine.StartCoroutine(LoadAll(cardDatas));

		Debug.Log("Card resources reloaded!");
	}

	public static IEnumerator LoadAll(CardAsset.Data[] cardDatas)
	{
		for (int i = 0; i < cardDatas.Length; i++)
		{
			CardAsset.Data cardData = cardDatas[i];
			yield return new WaitForEndOfFrame();
			RescanCardDirectory(cardData);
		}
	}

	static void RescanCardDirectory(CardAsset.Data cardData)
	{
		// Directories
		string cardsDir = "Cards/";
		string cardFamilyDir = cardsDir + "Tribes/" + cardData.familly + "/";
		string cardDir = cardFamilyDir + cardData.name + "/";
		string cardRarityDir = cardsDir + "Rarities/" + cardData.rarity + "/";
		string cardMaterialDir = cardsDir + "Materials/";

		// Load from resources folder
		var basicMaterial =
			(Material)Resources.Load(cardDir + cardData.name + " Basic", typeof(Material));
		var battlePrefab = 
			(GameObject)Resources.Load(cardDir + cardData.name + " Battle", typeof(GameObject));

		var deckIllustrationSubject =
			(Sprite)Resources.Load(cardDir + cardData.name + " Subject", typeof(Sprite));
		var deckIllustrationBackground =
			(Sprite)Resources.Load(cardDir + cardData.name + " Background", typeof(Sprite));
		var familyIcon =
			(Sprite)Resources.Load(cardFamilyDir + cardData.familly + " Icon", typeof(Sprite)
			);

		var rarityLayoutSprite =
			(Sprite)Resources.Load(cardRarityDir + cardData.rarity + " Layout Sprite", typeof(Sprite));
		var rarityLayoutMaterial =
			(Material)Resources.Load(cardRarityDir + cardData.rarity + " Layout Material", typeof(Material));
		var raritySummonEFX =
			(GameObject)Resources.Load(cardRarityDir + cardData.rarity + " Summon EFX", typeof(GameObject));

		var familyMaterial =
			(Material)Resources.Load(cardMaterialDir + "Family", typeof(Material));

		// Contain resources
		var rarityResources = new CardRarityResources(new CardRarityResources.Layout(rarityLayoutSprite, rarityLayoutMaterial),
														new CardRarityResources.EFX(raritySummonEFX));
		var resources = new CardResources(basicMaterial, battlePrefab, familyIcon, null, deckIllustrationSubject, deckIllustrationBackground, rarityResources, familyMaterial);

		// Assign resources with id in a list
		string id = "";
		foreach (CardAsset.Data cardDataFromDB in PersistentData.cardDatas)
			if (cardDataFromDB.name == cardData.name)
				id = cardDataFromDB.id;
		cardResourcesDictionary.Add(id, resources);
	}

	public static CardResources GetCardResources(string cardId)
	{
		return cardResourcesDictionary[cardId];
	}
}</code></pre>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

		<!-- Scripts -->
			<!-- <script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.dropotron.min.js"></script>
			<script src="assets/js/jquery.slidertron.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

			<script src="assets/js/custom.js"></script>
			<script src="assets/js/slideshow.js"></script>
			
			<script src="assets/js/popup-image.js"></script>
			
			<script src="assets/js/image-slider.js"></script>
			
			<script src="assets/js/slick.min.js"></script> -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.dropotron.min.js"></script>
			<script src="assets/js/jquery.slidertron.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>

			<script src="assets/js/loader.js"></script>

			<script src="assets/js/main.js"></script>
	
			<script src="assets/js/custom.js"></script>
			<script src="assets/js/project-elements.js"></script>
			<script src="assets/js/slideshow.js"></script>
			
			<script src="assets/js/popup-image.js"></script>
			<script src="assets/js/tabs.js"></script>
			
			<script src="assets/js/image-slider.js"></script>
			
		<!-- <script src="assets/js/slick.min.js"></script> -->
		<script src="slick-1.8.1/slick-1.8.1/slick/slick.min.js"></script>
	
			
			<script src="assets/js/navbar.js"></script>
			<!-- <script src="assets/js/parallax-scrolling.js"></script> -->
	
			<script src="assets/js/observers.js"></script>
	
			<script src="assets/js/accordion-single.js"></script>
		</body>
</html>